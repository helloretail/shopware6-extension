(this.webpackJsonp=this.webpackJsonp||[]).push([["helret-hello-retail"],{"/JcF":function(e,t){e.exports='<svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="24.000000pt" height="24.000000pt" viewBox="0 0 24.000000 24.000000"><g transform="translate(0.000000,24.000000) scale(0.100000,-0.100000)" fill="#758CA3" fill-rule="evenodd" stroke="none"><path d="M75 231 c-45 -20 -70 -60 -70 -112 0 -42 5 -53 33 -81 28 -28 39 -33 82 -33 43 0 54 5 82 33 28 28 33 39 33 82 0 42 -5 54 -31 81 -33 33 -92 46 -129 30z m95 -95 c0 -38 -21 -66 -50 -66 -10 0 -26 7 -34 16 -36 35 -7 84 50 84 32 0 34 -2 34 -34z"></path></g></svg>'},"0LTd":function(e,t){e.exports="<?xml version='1.0' ?>\n<orders totalOrdersCount='{{ ordersTotal }}'>\n"},"A+H8":function(e){e.exports=JSON.parse('{"sw-cms":{"blocks":{"commerce":{"hello-retail":{"label":"Hello Retail Integration"}}}},"helret-hello-retail":{"sales-channel-types":{"base":{"titleGeneralSettings":"Allgemeine Einstellungen","storefront":"Schaufenster","storefrontDomain":"Storefront-Domain","storefrontDomainCurrency":"Schaufensterwährung","feedDirectory":"Feed-Verzeichnis"}},"detail":{"placeholderFeedLocation":"Geben Sie den Feed-Standort ein...","titleFeedCard":"Einspeisungen","labelGenerateFeedsBtn":"Feed generieren","generateTooltip":"Bitte speichern Sie vor dem Generieren","feeds":{"productTitle":"Produkte","orderTitle":"Aufträge"}}}}')},Ag42:function(e,t,n){"use strict";n.r(t);const r=Shopware.Classes.ApiService;var a=class extends r{constructor(e,t,n="helret/hello-retail"){super(e,t,n),this.name="helloRetailService"}getTypeId(){return"44f7e183909376bb5824abf830f4b879"}generateFeed(e,t){return this.httpClient.post(`/${this.getApiBasePath()}/generateFeed/${e}/${t}`,{},{headers:this.getBasicHeaders()}).then(e=>r.handleResponse(e))}},l=(n("k5YH"),(()=>{const e=n("yE1W");return e.keys().reduce((t,n)=>{const r={name:n.split(".")[1].split("/")[1],functional:!0,render(t,r){const a=r.data;return t("span",{class:[a.staticClass,a.class],style:a.style,attrs:a.attrs,on:a.on,domProps:{innerHTML:e(n)}})}};return t.push(r),t},[])})());const{Component:i}=Shopware;l.map(e=>i.register(e.name,e));var s=n("ueag"),o=n.n(s),d=n("bGl5"),c=n.n(d),h=n("Dw8s"),p=n.n(h);Shopware.Service("helloRetailTemplateService").registerExportTemplate({name:"product",headerTemplate:o.a.trim(),bodyTemplate:c.a,footerTemplate:p.a.trim(),file:null,associations:["prices","categories","seoUrls","searchKeywords","manufacturer","media","cover","product.parent","properties.group"]});var f=n("0LTd"),u=n.n(f),m=n("cycj"),g=n.n(m),y=n("s9q6"),b=n.n(y);Shopware.Service("helloRetailTemplateService").registerExportTemplate({name:"order",headerTemplate:u.a.trim(),bodyTemplate:g.a,footerTemplate:b.a.trim(),file:null,associations:["lineItems.product","transactions","transactions.stateMachineState","transactions.paymentMethod","deliveries","deliveries.shippingMethod"]});var C=n("LQSL"),v=n.n(C);const{Component:w}=Shopware;w.override("sw-sales-channel-detail-base",{template:v.a,inject:["helloRetailService"],computed:{isHelloRetail(){return this.salesChannel&&-1!==this.salesChannel.typeId.indexOf(this.helloRetailService.getTypeId())}}});const{Component:S}=Shopware;S.override("sw-sales-channel-create-base",{template:v.a,watch:{typeId(){this.isHelloRetail&&(this.salesChannel.configuration={})}},computed:{isHelloRetail(){return this.$route.params.typeId===this.helloRetailService.getTypeId()}}});var _=n("pUFS"),I=n.n(_);const{Component:x,Mixin:k,Utils:F}=Shopware,{Criteria:T}=Shopware.Data,{mapApiErrors:D}=x.getComponentHelper();x.register("helret-sales-channel-hello-retail",{template:I.a,inject:["salesChannelService","repositoryFactory","helloRetailTemplateService","helloRetailService"],mixins:[k.getByName("placeholder"),k.getByName("notification")],props:{salesChannel:{type:Object,required:!0},isLoading:{type:Boolean,default:!1}},data:()=>({loading:!0,storefrontSalesChannelId:null,feedValues:[],feedGeneratingList:[],originalFeedValues:null}),created(){this.initChannel()},mounted(){Promise.all([this.fillSalesChannel()]).then(()=>{this.loading=!1})},computed:{...D("salesChannel",["name"]),storefrontSalesChannelCriteria:()=>(new T).addFilter(T.equals("typeId","8a243080f92e4c719546314b577cf82b")),storefrontSalesChannelDomainCriteria(){return(new T).addFilter(T.equals("salesChannelId",this.salesChannel.configuration.storefrontSalesChannelId||null))},globalDomainRepository(){return this.repositoryFactory.create("sales_channel_domain")},salesChannelRepository(){return this.repositoryFactory.create("sales_channel")},feedsList(){return Object.keys(this.salesChannel.configuration.feeds).sort((e,t)=>e.localeCompare(t))}},methods:{initChannel(){this.salesChannel.configuration||this.$set(this.salesChannel,"configuration",{feeds:this.helloRetailTemplateService.getExportTemplateRegistry(),feedDirectory:F.createId()}),this.salesChannel.configuration.feeds||this.$set(this.salesChannel.configuration,"feeds",this.helloRetailTemplateService.getExportTemplateRegistry()),this.salesChannel.configuration.feedDirectory||this.$set(this.salesChannel.configuration,"feedDirectory",F.createId()),this.originalFeedValues=JSON.parse(JSON.stringify(this.salesChannel.configuration.feeds))},fillSalesChannel(){if(!this.salesChannel.configuration.storefrontSalesChannelId)return this.salesChannelRepository.search(this.storefrontSalesChannelCriteria,Shopware.Context.api).then(e=>{if(1===e.total){const t=e.first().id;this.$set(this.salesChannel.configuration,"storefrontSalesChannelId",t),this.$refs.storefrontSalesChannelId.$emit("change",t)}return Promise.resolve()})},onStorefrontSelectionChange(e){e&&this.salesChannelRepository.get(e,Shopware.Context.api).then(e=>{this.salesChannel.languageId=e.languageId,this.salesChannel.languages=e.languages,this.salesChannel.currencyId=e.currencyId,this.salesChannel.paymentMethodId=e.paymentMethodId,this.salesChannel.shippingMethodId=e.shippingMethodId,this.salesChannel.countryId=e.countryId,this.salesChannel.navigationCategoryId=e.navigationCategoryId,this.salesChannel.navigationCategoryVersionId=e.navigationCategoryVersionId,this.salesChannel.customerGroupId=e.customerGroupId,this.salesChannel.configuration.storefrontSalesChannelId&&this.globalDomainRepository.search(this.storefrontSalesChannelDomainCriteria,Shopware.Context.api).then(e=>{1===e.total&&this.$set(this.salesChannel.configuration,"salesChannelDomainId",e.first().id)}),this.salesChannel.accessKey||this.generateKey(),this.forceUpdate()})},generateKey(){this.salesChannelService.generateKey().then(e=>{this.salesChannel.accessKey=e.accessKey}).catch(()=>{this.createNotificationError({title:this.$tc("sw-sales-channel.detail.titleAPIError"),message:this.$tc("sw-sales-channel.detail.messageAPIError")})})},forceUpdate(){this.$forceUpdate()},enableGenerateFeed(e){const t=this.originalFeedValues[e].file;return null!==t&&t===this.salesChannel.configuration.feeds[e].file},setFeedGenerating(e){this.isFeedGenerating(e)||this.feedGeneratingList.push(e)},isFeedGenerating(e){return this.feedGeneratingList.indexOf(e)>-1},removeFeedGenerating(e){this.feedGeneratingList.splice(this.feedGeneratingList.indexOf(e),1)},generateFeed(e){this.setFeedGenerating(e),this.helloRetailService.generateFeed(this.salesChannel.id,e).then(e=>{e.error?this.createNotificationError({title:this.$t("Error"),message:e.message}):this.createNotificationSuccess({title:this.$t("Success"),message:e.message})}).finally(()=>this.removeFeedGenerating(e))}}});var G=n("jEBK"),R=n.n(G);n("k6pR");Shopware.Component.register("sw-cms-block-hello-retail",{template:R.a});var $=n("wu3/"),M=n.n($);Shopware.Component.register("sw-cms-preview-hello-retail",{template:M.a}),Shopware.Service("cmsService").registerCmsBlock({name:"hello-retail",label:"sw-cms.blocks.commerce.hello-retail.label",category:"commerce",component:"sw-cms-block-hello-retail",previewComponent:"sw-cms-preview-hello-retail",defaultConfig:{marginBottom:"20px",marginTop:"20px",marginLeft:"20px",marginRight:"20px",sizingMode:"boxed"},slots:{content:{type:"text",default:{config:{content:{source:"static",value:"Enter Recommendation ID Here"}}}}}});var E=n("aC1G"),L=n("A+H8"),N=n("MGqg"),P=Shopware,H=P.Application,O=P.Locale;O.extend("en-GB",E),O.extend("de-DE",L),O.extend("da-DK",N),H.addServiceProvider("helloRetailService",(function(){var e=H.getContainer("service"),t=H.getContainer("init");return new a(t.httpClient,e.loginService)}))},Dw8s:function(e,t){e.exports="</products>\n"},LQSL:function(e,t){e.exports='{% block sw_sales_channel_detail_base %}\n    <span v-if="isHelloRetail">\n        <helret-sales-channel-hello-retail\n                   :isLoading="isLoading"\n                   :salesChannel="salesChannel">\n        </helret-sales-channel-hello-retail>\n    </span>\n    <span v-else>\n        {% parent %}\n    </span>\n{% endblock %}\n'},MGqg:function(e){e.exports=JSON.parse('{"sw-cms":{"blocks":{"commerce":{"hello-retail":{"label":"Hello Retail Integration"}}}},"helret-hello-retail":{"sales-channel-types":{"base":{"titleGeneralSettings":"Generelle indstillinger","storefront":"Storefront","storefrontDomain":"Storefront domæne","storefrontDomainCurrency":"Storefront valuta","feedDirectory":"Feed mappe"}},"detail":{"placeholderFeedLocation":"Indtast feed fil navn...","titleFeedCard":"Feeds","labelGenerateFeedsBtn":"Generere Feed","generateTooltip":"Gem venligst inden generering","feeds":{"productTitle":"Produkter","orderTitle":"Ordre"}}}}')},aC1G:function(e){e.exports=JSON.parse('{"sw-cms":{"blocks":{"commerce":{"hello-retail":{"label":"Hello Retail Integration"}}}},"helret-hello-retail":{"sales-channel-types":{"base":{"titleGeneralSettings":"General settings","storefront":"Storefront","storefrontDomain":"Storefront domain","storefrontDomainCurrency":"Storefront currency","feedDirectory":"Feed directory"}},"detail":{"placeholderFeedLocation":"Enter feed file name...","titleFeedCard":"Feeds","labelGenerateFeedsBtn":"Generate Feed","generateTooltip":"Please save before generating","feeds":{"productTitle":"Products","orderTitle":"Orders"}}}}')},bGl5:function(e,t){e.exports="<product>\n    <url>{{ seoUrl('frontend.detail.page', {'productId': product.id}) }}</url>\n    <title>{% if product.name %}{{ product.name }}{% else %}{{ product.translated.name }}{% endif %}</title>\n    <ean>{{ product.ean }}</ean>\n    <sku>{{ product.productNumber }}</sku>\n    {% if product.cover %}\n    {% set thumbnail = product.cover.media.thumbnails.elements|filter(img => img.width == 400)|first %}\n    <imgurl>{% if thumbnail %}{{ thumbnail.url }}{% else %}product.cover.media.url{% endif %}</imgurl>\n    {% else %}\n    <imgurl />\n    {% endif %}\n    {% set prices = product.prices.elements|first %}\n    <price>{% if prices %}{{ prices.price.elements|first.gross }}{% else %}{{ product.price.elements|first.gross }}{% endif %}</price>\n    <oldPrice>{% if product.price %}{{ product.price.elements|first.gross }}{% endif %}</oldPrice>\n    <productnumber>{{ product.productNumber }}</productnumber>\n    <hierarchies>\n        {% if product.categories %}\n            {% for category in product.categories.elements %}\n                <hierarchy>\n                    {% for breadCrumb in category.breadcrumb %}\n                        <category>{{ breadCrumb }}</category>\n                    {% endfor %}\n                </hierarchy>\n            {% endfor %}\n        {% endif %}\n    </hierarchies>\n    <keywords>{% if product.searchKeywords %}{% for keyword in product.searchKeywords.elements %}{{ keyword.keyword }},{% endfor %}{% endif %}</keywords>\n    {% set color = product.properties.elements|filter(property => property.group.name == 'Color')|first %}\n    <color>{% if color %}{{ color.name }}{% endif %}</color>\n    {% set gender = product.properties.elements|filter(property => property.group.name == 'Gender')|first %}\n    <gender>{% if gender %}{{ gender.name }}{% endif %}</gender>\n    <instock>{% if product.availableStock > 0 %}true{% else %}false{% endif %}</instock>\n    <description>{{ product.description }}</description>\n    <brand>{% if product.manufacturer %}{{ product.manufacturer.name }}{% endif %}</brand>\n</product>\n"},cycj:function(e,t){e.exports="<order>\n    <id>{{ order.id }}</id>\n    <orderNumber>{{ order.orderNumber }}</orderNumber>\n    <paymentStatus>\n        {% if order.transactions.last.stateMachineState.translated is defined %}\n            {{ order.transactions.last.stateMachineState.translated.name }}\n        {% endif %}\n    </paymentStatus>\n    <deliveryStatus>\n        {% if order.deliveries.first.stateMachineState.translated is defined %}\n            {{ order.deliveries.first.stateMachineState.translated.name }}\n        {% endif %}\n    </deliveryStatus>\n    <orderStatus>\n        {% if order.stateMachineState.translated is defined %}\n            {{ order.stateMachineState.translated.name }}\n        {% endif %}\n    </orderStatus>\n    {% if order.lineItems %}\n        <orderProducts>\n            {% for lineItem in order.lineItems.elements %}\n                {% if lineItem.product and lineItem.payload.productNumber is defined %}\n                    <product>\n                        <id>{{ lineItem.productId }}</id>\n                        <url>{{ seoUrl('frontend.detail.page', {'productId': lineItem.productId}) }}</url>\n                        <productNumber>{{ lineItem.payload.productNumber }}</productNumber>\n                        <quantity>{{ lineItem.quantity }}</quantity>\n                        <price>{{ lineItem.unitPrice }}</price>\n                        <priceNoTax>{{ lineItem.unitPrice - lineItem.price.calculatedTaxes.first.tax  }}</priceNoTax>\n                    </product>\n                {% endif %}\n            {% endfor %}\n        </orderProducts>\n    {% endif %}\n    <shippingPrice>{{ order.shippingTotal }}</shippingPrice>\n    <createdDate>{{ order.orderDateTime|date('Y-m-d H:i:s') }}</createdDate>\n    <CreatedDateWithoutTime>{{ order.orderDateTime|date('Y-m-d') }}</CreatedDateWithoutTime>\n    <total>{{ order.amountTotal }}</total>\n    <email>{{ order.orderCustomer.email }}</email>\n    <paymentMethod>\n        {% if order.transactions.last.paymentMethod.translated is defined %}\n            {{ order.transactions.last.paymentMethod.translated.name }}\n        {%  endif %}\n    </paymentMethod>\n    <shippingMethod>\n        {% if order.deliveries.first.shippingMethod.translated is defined %}\n            {{ order.deliveries.first.shippingMethod.translated.name }}\n        {%  endif %}\n    </shippingMethod>\n</order>\n"},jEBK:function(e,t){e.exports='{% block sw_cms_block_hello_retail %}\n    <div class="sw-cms-block-hello-retail">\n        <img :src="\'helrethelloretail/static/img/HR_logo_primary1_no-payoff.png\' | asset">\n        <slot name="content">{% block sw_cms_block_hello_retail_slot_content %}{% endblock %}</slot>\n    </div>\n{% endblock %}\n'},k5YH:function(e,t){const{Application:n}=Shopware;n.addServiceProvider("helloRetailTemplateService",()=>({registerExportTemplate:a,getExportTemplateByName:l,getExportTemplateRegistry:i}));const r={};function a(e){return r[e.name]=e,!0}function l(e){return r[e]}function i(){return r}},k6pR:function(e,t,n){var r=n("yjFF");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,n("SZ7m").default)("3ad95270",r,!0,{})},pUFS:function(e,t){e.exports='{% block sw_sales_channel_detail_base %}\n    <div v-if="salesChannel" class="sw-sales-channel-detail-base">\n\n        {% block sw_sales_channel_detail_base_general %}\n            <sw-card :isLoading="loading"\n                     :title="$tc(\'helret-hello-retail.sales-channel-types.base.titleGeneralSettings\')">\n                <sw-container columns="1fr 200px" gap="0px 30px">\n                    {% block sw_sales_channel_detail_base_general_name %}\n                        <sw-text-field\n                            v-model="salesChannel.name"\n                            type="text"\n                            validation="required"\n                            required\n                            :error="salesChannelNameError"\n                            :placeholder="placeholder(salesChannel, \'name\', $tc(\'sw-sales-channel.detail.placeholderName\'))"\n                            :label="$tc(\'sw-sales-channel.detail.labelInputName\')">\n                        </sw-text-field>\n                    {% endblock %}\n\n                    {% block sw_sales_channel_detail_base_general_input_active %}\n                        <sw-switch-field\n                            v-model="salesChannel.active"\n                            bordered\n                            :label="$tc(\'sw-sales-channel.detail.labelInputActive\')">\n                        </sw-switch-field>\n                    {% endblock %}\n                </sw-container>\n\n                {% block sw_sales_channel_detail_base_general_storefront %}\n                    <sw-entity-single-select\n                        ref="storefrontSalesChannelId"\n                        v-model="salesChannel.configuration.storefrontSalesChannelId"\n                        :label="$tc(\'helret-hello-retail.sales-channel-types.base.storefront\')"\n                        :criteria="storefrontSalesChannelCriteria"\n                        labelProperty="name"\n                        valueProperty="id"\n                        entity="sales_channel"\n                        required\n                        @change="onStorefrontSelectionChange">\n                    </sw-entity-single-select>\n                {% endblock %}\n\n                {% block sw_sales_channel_detail_base_general_storefront_domain %}\n                    <sw-entity-single-select\n                        v-model="salesChannel.configuration.salesChannelDomainId"\n                        required\n                        :label="$tc(\'helret-hello-retail.sales-channel-types.base.storefrontDomain\')"\n                        :criteria="storefrontSalesChannelDomainCriteria"\n                        labelProperty="url"\n                        valueProperty="id"\n                        entity="sales_channel_domain"\n                        :disabled="!salesChannel.configuration.salesChannelDomainId && !salesChannel.configuration.storefrontSalesChannelId"\n                        @input="forceUpdate">\n                    </sw-entity-single-select>\n                {% endblock %}\n\n                {% block sw_sales_channel_detail_base_general_feed_directory %}\n                    <sw-text-field\n                        :value="salesChannel.configuration.feedDirectory"\n                        :label="$tc(\'helret-hello-retail.sales-channel-types.base.feedDirectory\')"\n                        disabled>\n                        <template #suffix>\n                            <sw-field-copyable :copyableText="salesChannel.configuration.feedDirectory"></sw-field-copyable>\n                        </template>\n                    </sw-text-field>\n                {% endblock %}\n\n            </sw-card>\n        {% endblock %}\n\n        <sw-card v-if="salesChannel.configuration.feeds" :isLoading="loading"\n                 :title="$tc(\'helret-hello-retail.detail.titleFeedCard\')">\n            <sw-text-field v-for="feed in feedsList"\n                           :key="feed"\n                           v-model="salesChannel.configuration.feeds[feed].file"\n                           type="text"\n                           :placeholder="placeholder(salesChannel, `configuration.feeds.${feed}.file`, $tc(\'helret-hello-retail.detail.placeholderFeedLocation\'))"\n                           :label="$tc(`helret-hello-retail.detail.feeds.${feed}Title`)">\n                <template slot="suffix">\n                    <sw-button\n                        :isLoading="isFeedGenerating(feed)"\n                        :disabled="!enableGenerateFeed(feed)"\n                        v-tooltip="{\n                            message: $tc(\'helret-hello-retail.detail.generateTooltip\'),\n                            disabled: enableGenerateFeed(feed),\n                            showOnDisabledElements: true\n                        }"\n                        @click="generateFeed(feed)"\n                        variant="primary">\n                        {{ $tc(\'helret-hello-retail.detail.labelGenerateFeedsBtn\') }}\n                    </sw-button>\n                </template>\n            </sw-text-field>\n        </sw-card>\n    </div>\n{% endblock %}\n'},s9q6:function(e,t){e.exports="</orders>\n"},ueag:function(e,t){e.exports='<?xml version="1.0" ?>\n<products totalProductsCount="{{ productsTotal }}">\n'},"wu3/":function(e,t){e.exports='{% block sw_cms_block_hello_retail_preview %}\n    <div class="sw-cms-preview-hello-retail">\n        <img :src="\'helrethelloretail/static/img/HR_logo_primary1_no-payoff.png\' | asset">\n    </div>\n{% endblock %}\n'},yE1W:function(e,t,n){var r={"./icons-brand-hello-retail.svg":"/JcF"};function a(e){var t=l(e);return n(t)}function l(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=l,e.exports=a,a.id="yE1W"},yjFF:function(e,t,n){}},[["Ag42","runtime","vendors-node"]]]);