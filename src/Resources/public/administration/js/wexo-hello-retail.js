(this.webpackJsonp=this.webpackJsonp||[]).push([["wexo-hello-retail"],{"+/4i":function(e,n,t){var a={"./icons-brand-hello-retail.svg":"WHdM"};function r(e){var n=s(e);return t(n)}function s(e){if(!t.o(a,e)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=s,e.exports=r,r.id="+/4i"},"3m2+":function(e,n,t){"use strict";t.r(n);const a=Shopware.Classes.ApiService;var r=class extends a{constructor(e,n,t="wexo/hello-retail"){super(e,n,t),this.name="helloRetailService"}getTypeId(){return"44f7e183909376bb5824abf830f4b879"}generateFeed(e,n){return this.httpClient.post(`/${this.getApiBasePath()}/generateFeed/${e}/${n}`,{},{headers:this.getBasicHeaders()}).then(e=>a.handleResponse(e))}},s=(t("xVwO"),(()=>{const e=t("+/4i");return e.keys().reduce((n,t)=>{const a={name:t.split(".")[1].split("/")[1],functional:!0,render(n,a){const r=a.data;return n("span",{class:[r.staticClass,r.class],style:r.style,attrs:r.attrs,on:r.on,domProps:{innerHTML:e(t)}})}};return n.push(a),n},[])})());const{Component:i}=Shopware;s.map(e=>i.register(e.name,e));var o=t("giJI"),l=t.n(o),d=t("CYBZ"),c=t.n(d),p=t("qHz6"),h=t.n(p);Shopware.Service("helloRetailTemplateService").registerExportTemplate({name:"product",headerTemplate:l.a.trim(),bodyTemplate:c.a,footerTemplate:h.a.trim(),file:null,associations:["prices","categories","seoUrls","searchKeywords","manufacturer","media","cover","product.parent","properties.group"]});var u=t("ElGi"),f=t.n(u),m=t("sVer"),g=t.n(m),C=t("C5yi"),y=t.n(C);Shopware.Service("helloRetailTemplateService").registerExportTemplate({name:"order",headerTemplate:f.a.trim(),bodyTemplate:g.a,footerTemplate:y.a.trim(),file:null,associations:["lineItems.product","transactions","transactions.stateMachineState","transactions.paymentMethod","deliveries","deliveries.shippingMethod"]});t("v2RS");var w=t("kKFc"),b=t.n(w);const{Component:v}=Shopware;v.override("sw-sales-channel-detail-base",{template:b.a,inject:["helloRetailService"],computed:{isHelloRetail(){return this.salesChannel&&-1!==this.salesChannel.typeId.indexOf(this.helloRetailService.getTypeId())}}});const{Component:S}=Shopware;S.override("sw-sales-channel-create-base",{template:b.a,watch:{typeId(){this.isHelloRetail&&(this.salesChannel.configuration={})}},computed:{isHelloRetail(){return this.$route.params.typeId===this.helloRetailService.getTypeId()}}});var x=t("BfU6"),I=t.n(x);const{Component:_,Mixin:T}=Shopware,{Criteria:k}=Shopware.Data,{mapApiErrors:P}=_.getComponentHelper();_.register("wexo-sales-channel-hello-retail",{template:I.a,inject:["salesChannelService","repositoryFactory","helloRetailTemplateService","helloRetailService"],mixins:[T.getByName("placeholder"),T.getByName("notification")],props:{salesChannel:{type:Object,required:!0},isLoading:{type:Boolean,default:!1}},data:()=>({loading:!0,storefrontSalesChannelId:null,feedValues:[]}),created(){this.initChannel()},mounted(){Promise.all([this.fillSalesChannel()]).then(()=>{this.loading=!1})},computed:{...P("salesChannel",["name"]),storefrontSalesChannelCriteria:()=>(new k).addFilter(k.equals("typeId","8a243080f92e4c719546314b577cf82b")),storefrontSalesChannelDomainCriteria(){return(new k).addFilter(k.equals("salesChannelId",this.salesChannel.configuration.storefrontSalesChannelId||null))},globalDomainRepository(){return this.repositoryFactory.create("sales_channel_domain")},salesChannelRepository(){return this.repositoryFactory.create("sales_channel")},feedsList(){return Object.keys(this.salesChannel.configuration.feeds).sort((e,n)=>e.localeCompare(n))}},methods:{initChannel(){this.salesChannel.configuration||this.$set(this.salesChannel,"configuration",{}),this.salesChannel.configuration.feeds||this.$set(this.salesChannel.configuration,"feeds",this.helloRetailTemplateService.getExportTemplateRegistry())},fillSalesChannel(){if(!this.salesChannel.configuration.storefrontSalesChannelId)return this.salesChannelRepository.search(this.storefrontSalesChannelCriteria,Shopware.Context.api).then(e=>{if(1===e.total){const n=e.first().id;this.$set(this.salesChannel.configuration,"storefrontSalesChannelId",n),this.$refs.storefrontSalesChannelId.$emit("change",n)}return Promise.resolve()})},onStorefrontSelectionChange(e){e&&this.salesChannelRepository.get(e,Shopware.Context.api).then(e=>{this.salesChannel.languageId=e.languageId,this.salesChannel.languages=e.languages,this.salesChannel.currencyId=e.currencyId,this.salesChannel.paymentMethodId=e.paymentMethodId,this.salesChannel.shippingMethodId=e.shippingMethodId,this.salesChannel.countryId=e.countryId,this.salesChannel.navigationCategoryId=e.navigationCategoryId,this.salesChannel.navigationCategoryVersionId=e.navigationCategoryVersionId,this.salesChannel.customerGroupId=e.customerGroupId,this.salesChannel.configuration.storefrontSalesChannelId&&this.globalDomainRepository.search(this.storefrontSalesChannelDomainCriteria,Shopware.Context.api).then(e=>{1===e.total&&this.$set(this.salesChannel.configuration,"salesChannelDomainId",e.first().id)}),this.salesChannel.accessKey||this.generateKey(),this.forceUpdate()})},generateKey(){this.salesChannelService.generateKey().then(e=>{this.salesChannel.accessKey=e.accessKey}).catch(()=>{this.createNotificationError({title:this.$tc("sw-sales-channel.detail.titleAPIError"),message:this.$tc("sw-sales-channel.detail.messageAPIError")})})},forceUpdate(){this.$forceUpdate()},generateFeed(e){this.helloRetailService.generateFeed(this.salesChannel.id,e).then(e=>{e.error?this.createNotificationError({title:this.$t("Error"),message:e.message}):this.createNotificationSuccess({title:this.$t("Success"),message:e.message})})}}});var R=t("Z4+T"),M=Shopware.Application;Shopware.Locale.extend("en-GB",R),Shopware.Locale.extend("de-DE",R),Shopware.Locale.extend("da-DK",R),M.addServiceProvider("helloRetailService",(function(){var e=M.getContainer("service"),n=M.getContainer("init");return new r(n.httpClient,e.loginService)}))},BfU6:function(e,n){e.exports='{% block sw_sales_channel_detail_base %}\n<div v-if="salesChannel" class="sw-sales-channel-detail-base">\n\n    {% block sw_sales_channel_detail_base_general %}\n        <sw-card :isLoading="loading" :title="$tc(\'wexo-hello-retail.sales-channel-types.base.titleGeneralSettings\')">\n            <sw-container columns="1fr 200px" gap="0px 30px">\n                {% block sw_sales_channel_detail_base_general_name %}\n                    <sw-text-field\n                        v-model="salesChannel.name"\n                        type="text"\n                        validation="required"\n                        required\n                        :error="salesChannelNameError"\n                        :placeholder="placeholder(salesChannel, \'name\', $tc(\'sw-sales-channel.detail.placeholderName\'))"\n                        :label="$tc(\'sw-sales-channel.detail.labelInputName\')">\n                    </sw-text-field>\n                {% endblock %}\n\n                {% block sw_sales_channel_detail_base_general_input_active %}\n                    <sw-switch-field\n                        v-model="salesChannel.active"\n                        bordered\n                        :label="$tc(\'sw-sales-channel.detail.labelInputActive\')">\n                    </sw-switch-field>\n                {% endblock %}\n            </sw-container>\n\n            {% block sw_sales_channel_detail_base_general_storefront %}\n                <sw-entity-single-select\n                    ref="storefrontSalesChannelId"\n                    v-model="salesChannel.configuration.storefrontSalesChannelId"\n                    :label="$tc(\'wexo-hello-retail.sales-channel-types.base.storefront\')"\n                    :criteria="storefrontSalesChannelCriteria"\n                    labelProperty="name"\n                    valueProperty="id"\n                    entity="sales_channel"\n                    required\n                    @change="onStorefrontSelectionChange">\n                </sw-entity-single-select>\n            {% endblock %}\n\n            {% block sw_sales_channel_detail_base_general_storefront_domain %}\n                <sw-entity-single-select\n                    v-model="salesChannel.configuration.salesChannelDomainId"\n                    required\n                    :label="$tc(\'wexo-hello-retail.sales-channel-types.base.storefrontDomain\')"\n                    :criteria="storefrontSalesChannelDomainCriteria"\n                    labelProperty="url"\n                    valueProperty="id"\n                    entity="sales_channel_domain"\n                    :disabled="!salesChannel.configuration.salesChannelDomainId && !salesChannel.configuration.storefrontSalesChannelId"\n                    @input="forceUpdate">\n                </sw-entity-single-select>\n            {% endblock %}\n\n        </sw-card>\n    {% endblock %}\n\n    <sw-card v-if="salesChannel.configuration.feeds" :isLoading="loading" :title="$tc(\'wexo-hello-retail.detail.titleFeedCard\')">\n        <sw-text-field v-for="feed in feedsList"\n                       :key="feed"\n                       v-model="salesChannel.configuration.feeds[feed].file"\n                       type="text"\n                       :placeholder="placeholder(salesChannel, `configuration.feeds.${feed}.file`, $tc(\'wexo-hello-retail.detail.placeholderFeedLocation\'))"\n                       :label="$tc(`wexo-hello-retail.detail.feeds.${feed}Title`)">\n            <template slot="suffix">\n                <sw-button\n                    :isLoading="loading"\n                    :disabled="loading"\n                    @click="generateFeed(feed)"\n                    variant="primary">\n                    {{ $tc(\'wexo-hello-retail.detail.labelGenerateFeedsBtn\') }}\n                </sw-button>\n            </template>\n        </sw-text-field>\n    </sw-card>\n</div>\n{% endblock %}\n'},C5yi:function(e,n){e.exports="</orders>\n"},CYBZ:function(e,n){e.exports="<product>\n    <url>{{ seoUrl('frontend.detail.page', {'productId': product.id}) }}</url>\n    <title>{% if product.name %}{{ product.name }}{% else %}{{ product.translated.name }}{% endif %}</title>\n    <ean>{{ product.productNumber }}</ean>\n    <sku>{{ product.productNumber }}</sku>\n    {% if product.cover %}\n    {% set thumbnail = product.cover.media.thumbnails.elements|filter(img => img.width == 400)|first %}\n    <imgurl>{% if thumbnail %}{{ thumbnail.url }}{% else %}product.cover.media.url{% endif %}</imgurl>\n    {% else %}\n    <imgurl />\n    {% endif %}\n    {% set prices = product.prices.elements|first %}\n    <price>{% if prices %}{{ prices.price.elements|first.gross }}{% else %}{{ product.price.elements|first.gross }}{% endif %}</price>\n    <oldPrice>{% if product.price %}{{ product.price.elements|first.gross }}{% endif %}</oldPrice>\n    <productnumber>{{ product.productNumber }}</productnumber>\n    <hierarchies>\n        {% if product.categories %}\n            {% for category in product.categories.elements %}\n                <hierarchy>\n                    {% for breadCrumb in category.breadcrumb %}\n                        <category>{{ breadCrumb }}</category>\n                    {% endfor %}\n                </hierarchy>\n            {% endfor %}\n        {% endif %}\n    </hierarchies>\n    <keywords>{% if product.searchKeywords %}{% for keyword in product.searchKeywords.elements %}{{ keyword.keyword }},{% endfor %}{% endif %}</keywords>\n    {% set color = product.properties.elements|filter(property => property.group.name == 'Farve')|first %}\n    <color>{% if color %}{{ color.name }}{% endif %}</color>\n    {% set gender = product.properties.elements|filter(property => property.group.name == 'KÃ¸n')|first %}\n    <gender>{% if gender %}{{ gender.name }}{% endif %}</gender>\n    <instock>{% if product.availableStock > 0 %}true{% else %}false{% endif %}</instock>\n    <description>{{ product.description }}</description>\n    <brand>{% if product.manufacturer %}{{ product.manufacturer.name }}{% endif %}</brand>\n</product>\n"},ElGi:function(e,n){e.exports="<?xml version='1.0' ?>\n<orders totalOrdersCount='{{ ordersTotal }}'>\n"},WHdM:function(e,n){e.exports='<svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="24.000000pt" height="24.000000pt" viewBox="0 0 24.000000 24.000000"><g transform="translate(0.000000,24.000000) scale(0.100000,-0.100000)" fill="#758CA3" fill-rule="evenodd" stroke="none"><path d="M75 231 c-45 -20 -70 -60 -70 -112 0 -42 5 -53 33 -81 28 -28 39 -33 82 -33 43 0 54 5 82 33 28 28 33 39 33 82 0 42 -5 54 -31 81 -33 33 -92 46 -129 30z m95 -95 c0 -38 -21 -66 -50 -66 -10 0 -26 7 -34 16 -36 35 -7 84 50 84 32 0 34 -2 34 -34z"></path></g></svg>'},"Z4+T":function(e){e.exports=JSON.parse('{"wexo-hello-retail":{"sales-channel-types":{"base":{"titleGeneralSettings":"General settings","titleOptions":"Options","storefront":"Storefront","storefrontDomain":"Storefront domain","storefrontDomainCurrency":"Storefront currency","productStream":"Dynamic product group","noDynamicProductGroupFound":"You need to create a dynamic product group in order to use the social shopping sales channel. Please create a dynamic product group.","createDynamicProductGroup":"Create dynamic product group","tabErrors":"Unpublished products"},"helloRetail":{"titlePinterestSettings":"Additional settings","titlePinterestGuide":"Integration guide","validationButtonTitle":"Validate on Pinterest","name":"Hello Retail","description":"Sell products via Pinterest","integrationStep1":"This sales channel generates metadata that allows you to display your products as a pin on Pinterest. You can find more information about this topic in our documentation.","manufacturer":"shopware AG","descriptionLong":"Create a Sales Channel to sell your products on Pinterest."}},"detail":{"placeholderFeedLocation":"Enter Feed Location...","titleFeedCard":"Feeds","labelGenerateFeedsBtn":"Generate Feed","feeds":{"productTitle":"Products","customerTitle":"Customers","orderTitle":"Orders"}}}}')},giJI:function(e,n){e.exports='<?xml version="1.0" ?>\n<products totalProductsCount="{{ productsTotal }}">\n'},kKFc:function(e,n){e.exports='{% block sw_sales_channel_detail_base %}\n    <span v-if="isHelloRetail">\n        <wexo-sales-channel-hello-retail\n                   :isLoading="isLoading"\n                   :salesChannel="salesChannel">\n        </wexo-sales-channel-hello-retail>\n    </span>\n    <span v-else>\n        {% parent %}\n    </span>\n{% endblock %}\n'},qHz6:function(e,n){e.exports="</products>\n"},sVer:function(e,n){e.exports="<order>\n    <id>{{ order.id }}</id>\n    <orderNumber>{{ order.orderNumber }}</orderNumber>\n    <paymentStatus>\n        {% if order.transactions.last.stateMachineState.translated is defined %}\n            {{ order.transactions.last.stateMachineState.translated.name }}\n        {% endif %}\n    </paymentStatus>\n    <deliveryStatus>\n        {% if order.deliveries.first.stateMachineState.translated is defined %}\n            {{ order.deliveries.first.stateMachineState.translated.name }}\n        {% endif %}\n    </deliveryStatus>\n    <orderStatus>\n        {% if order.stateMachineState.translated is defined %}\n            {{ order.stateMachineState.translated.name }}\n        {% endif %}\n    </orderStatus>\n    {% if order.lineItems %}\n        <orderProducts>\n            {% for lineItem in order.lineItems.elements %}\n                {% if lineItem.product and lineItem.payload.productNumber is defined %}\n                    <product>\n                        <id>{{ lineItem.productId }}</id>\n                        <url>{{ seoUrl('frontend.detail.page', {'productId': lineItem.productId}) }}</url>\n                        <productNumber>{{ lineItem.payload.productNumber }}</productNumber>\n                        <quantity>{{ lineItem.quantity }}</quantity>\n                        <price>{{ lineItem.unitPrice }}</price>\n                        <priceNoTax>{{ lineItem.unitPrice - lineItem.price.calculatedTaxes.first.tax  }}</priceNoTax>\n                    </product>\n                {% endif %}\n            {% endfor %}\n        </orderProducts>\n    {% endif %}\n    <shippingPrice>{{ order.shippingTotal }}</shippingPrice>\n    <createdDate>{{ order.orderDateTime|date('Y-m-d H:i:s') }}</createdDate>\n    <total>{{ order.amountTotal }}</total>\n    <email>{{ order.orderCustomer.email }}</email>\n    <paymentMethod>\n        {% if order.transactions.last.paymentMethod.translated is defined %}\n            {{ order.transactions.last.paymentMethod.translated.name }}\n        {%  endif %}\n    </paymentMethod>\n    <shippingMethod>\n        {% if order.deliveries.first.shippingMethod.translated is defined %}\n            {{ order.deliveries.first.shippingMethod.translated.name }}\n        {%  endif %}\n    </shippingMethod>\n</order>\n"},v2RS:function(e,n){Shopware.Service("helloRetailTemplateService").registerExportTemplate({name:"customer",headerTemplate:null,bodyTemplate:null,footerTemplate:null,file:null,associations:[]})},xVwO:function(e,n){const{Application:t}=Shopware;t.addServiceProvider("helloRetailTemplateService",()=>({registerExportTemplate:r,getExportTemplateByName:s,getExportTemplateRegistry:i}));const a={};function r(e){return a[e.name]=e,!0}function s(e){return a[e]}function i(){return a}}},[["3m2+","runtime"]]]);